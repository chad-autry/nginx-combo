[Unit]
Description=NGINX
# Dependencies
Requires=docker.service
Requires=certificate-sync.service
Requires=nginx-config-sync.service
Requires=acme-response-sync.service

# Ordering
After=docker.service
After=certificate-sync.service
After=nginx-config-sync.service
After=acme-response-sync.service

[Service]
ExecStartPre=-/usr/bin/docker pull chadautry/wac-nginx
ExecStartPre=-/usr/bin/docker rm nginx
ExecStart=/usr/bin/docker run --name nginx -p 80:80 -p 443:443 \
-v /var/www:/usr/share/nginx/html:ro -v /etc/ssl:/etc/nginx/ssl:ro \
-d chadautry/wac-nginx
Restart=on-failure

[X-Fleet]
Global=true
MachineMetadata=frontend=true
